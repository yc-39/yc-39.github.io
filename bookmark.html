<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>yc常用书签</title>
    <script src="lib/jquery/1.9.1/jquery.js"></script>
    <script src="lib/h-ui/js/H-ui.js"></script>
    <link rel="stylesheet" type="text/css" href="lib/h-ui/css/H-ui.css" />
    <script src="./json/bookmark.json"></script>
    <link rel="stylesheet" href="./css/bookmark.css">
</head>
<body>

    <div class="tag-div"></div>
    <div class="bookmark-div"></div>


    <script>
    var bookmark_json = bookmark_json;
    var tag_json = [];
    var tags = [];
    // 获取全部tag，并分类
    for (let i in bookmark_json) {
        let tags_temp = bookmark_json[i].tag.split(",");
        for (let j in tags_temp) {
            let exist = false;
            for (let k in tags) {
                if (tags[k] == tags_temp[j]) {
                    exist = true;
                    break;
                }
            }
            if (!exist) {
                tags.push(tags_temp[j]);
            }
        }
    }

    let str = "";
    str += "<span class=\"btn btn-default radius tag-btn\">全部</span>";
    for (let i in tags) {
        str += "<span class=\"btn btn-default radius tag-btn\">" + tags[i] + "</span>";
    }
    $(".tag-div").html(str);



    $(".tag-btn").click(function() {
        bookmarkByTag($(this).html());
    })

    function bookmarkByTag(_tag) {
        let str = "";
        str += "<table class=\"bookmark_table table table-border table-bordered table-hover radius\">";
        str += "  <thead class=\"text-shadow c-666\">";
        str += "    <td class=\"text-c\">icon</td>";
        str += "    <td class=\"text-c\">网站</td>";
        str += "    <td class=\"text-c\">url</td>";
        str += "    <td class=\"text-c\">备注</td>";
        str += "    <td class=\"text-c\">tag</td>";
        str += "  </thead>";
        for (let i in bookmark_json) {
            if (_tag!="全部" && !isIncludeTag(bookmark_json[i].tag, _tag)) {
                continue;
            }
            str += "</tr>";
            str += "<td class=\"bookmark_icon\"><img src=\"" + bookmark_json[i].icon + "\"></td>";
            str += "<td class=\"bookmark_name\"><a href=\"" + bookmark_json[i].url + "\" target=\"_blank\">" + bookmark_json[i].name + "</a></td>";
            str += "<td class=\"bookmark_link\"><a href=\"" + bookmark_json[i].url + "\" target=\"_blank\">" + bookmark_json[i].url + "</a></td>";
            str += "<td class=\"bookmark_link\"><a href=\"" + bookmark_json[i].url + "\" target=\"_blank\">" + bookmark_json[i].memo + "</a></td>";
            str += "<td class=\"bookmark_link\"><a href=\"" + bookmark_json[i].url + "\" target=\"_blank\">" + bookmark_json[i].tag + "</a></td>";
            str += "</tr>";
        }
        str += "</table>";

        $(".bookmark-div").html(str);
    }


    function isIncludeTag(_tags, _tag) {
        let flag = false;
        let tags = _tags.split(",");
        for (let i in tags) {
            if (tags[i] == _tag) {
                flag = true;
                break;
            }
        }
        return flag;
    }

    </script>

</body>
</html>